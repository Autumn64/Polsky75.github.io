<!DOCTYPE html>
<html>
<head>
	<meta charset="UTF-8">
	<title id="str">Ешь яблоки!</title>
</head>
<body>
  <canvas id = "canvas" width = "400" height = "400"></canvas> 
	<script src="https://code.jquery.com/jquery-2.1.0.js"></script>
	<script>
   	var canvas = document.getElementById("canvas");
	var ctx = canvas.getContext("2d");
	var w = canvas.width
	var h = canvas.height
	var blockSize = 10
	var blockW = w/blockSize
	var blockH = h/blockSize
	var score = 0
	var circle = function (x,y,radius,fillCircle) {
  	ctx.beginPath();
  	ctx.arc(x, y, radius, 0, Math.PI * 2, false);
	if(fillCircle === true){
    	ctx.fill();
	}else{
	ctx.stroke();
	}
  	}
	var drawBorder = function(){
	ctx.fillStyle = "Gray"
	ctx.fillRect(0,0,w,blockSize)
	ctx.fillRect(0,h-blockSize,w,blockSize)
	ctx.fillRect(0,0,blockSize,h)
	ctx.fillRect(w-blockSize,0,blockSize,h)
	};
	var drawScore = function(){
	ctx.font = "20px courier";
	ctx.fillStyle = "Black";
	ctx.textAlign = "Left";
	ctx.textBaseline = "top";
	ctx.fillText("Счет: " + score,blockSize,blockSize)
	}
	drawBorder();
	var gameOver = function(){
	clearInterval(intervalId)
	ctx.font = "60px courier";
	ctx.fillStyle = "Black";
	ctx.textAlign = "center";
	ctx.textBaseline = "middle";
	ctx.fillText("Конец игры", w/2, h/2);
	}
	//var xScore = setInterval(function(){
	//ctx.clearRect(0,0,w,h)
	//score++
	//drawBorder();
	//drawScore();
	//}, 100)
	var Block = function (col,row){
	this.col = col
	this.row = row
	};
	Block.prototype.drawSquare = function(colour){
	var x = this.col * blockSize;
	var y = this.row * blockSize;
	ctx.fillStyle = colour;
	ctx.fillRect(x, y, blockSize, blockSize)
	}
	Block.prototype.drawCircle = function(colour){
	var centerX = this.col * blockSize + blockSize/2;
	var centerY = this.row * blockSize + blockSize/2;
	ctx.fillStyle = colour;
	circle(centerX, centerY, blockSize/2, true)
	}
	Block.prototype.equal = function(otherBlock){
	return this.col === other.col && this.row === other.row
	};
	var Snake = function(){
	this.cegments = [
	new Block(7,5),
	new Block(6,5),
	new Block(5,5)
	];
	this.direction = "right";
	this.nextDirection = "right";
	};
	Snake.prototype.draw = function(){
	for (var i = 0; i < this.cegments.length; i++){
	this.cegments[i].drawSquare("Blue");
	}
	};
	Snake.prototype.move = function(){
	var head = this.cegments[0];
	var newHead;
	this.direction = this.nextDirection
	if (this.direction === "right") {
	newHead = new Block(head.col + 1, head.row);
	} else if (this.direction === "down") {
	newHead = new Block(head.col, head.row + 1);
	} else if (this.direction === "left") {
	newHead = new Block(head.col - 1, head.row);
	} else if (this.direction === "down") {
	newHead = new Block(head.col, head.row - 1);
	};
	if (this.checkCollision(newHead)){
	gameOver();
	return
	}
	this.cegments.unshift(newHead);
	//if (newHead.equal(apple.position)){
	//score++;
	//apple.move;
	//}else{
	this.cegments.pop();
	//}
	//};
	snake.prototype.checkCollision = function(head){
	var leftCollision = (head.col === 0);
	var topCollision = (head.row === 0);
	var rightCollision = (head.col === blockW - 1)
	var bottomCollision = (head.row === blockH - 1)
	var wallCollision = leftCollision||topCollision||rightCollision||bottomCollision
	var selfCollision = false;
	for (var i = 0; i < this.cegments.length; i++){
	if (head.equal(this.cegments[i])){
		selfCollision = true
	}
	}
	return wallCollision || selfCollision
	};
	</script>
</body>
</html>
